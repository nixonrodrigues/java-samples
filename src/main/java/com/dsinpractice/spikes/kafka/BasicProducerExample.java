package com.dsinpractice.spikes.kafka;

import org.apache.kafka.clients.CommonClientConfigs;
import org.apache.kafka.clients.producer.Callback;
import org.apache.kafka.clients.producer.KafkaProducer;
import org.apache.kafka.clients.producer.Producer;
import org.apache.kafka.clients.producer.ProducerConfig;
import org.apache.kafka.clients.producer.ProducerRecord;
import org.apache.kafka.clients.producer.RecordMetadata;
import org.apache.kafka.common.config.SslConfigs;

import java.util.Properties;
import java.util.Random;

public class BasicProducerExample {

    public static void main(String[] args){

        int from = 0;
        int to = 10;
        String bootstrapserver = "localhost:9027";
        try{
            from = Integer.parseInt(args[0]);
            to = Integer.parseInt(args[1]);
            bootstrapserver = args[2];
        }catch (Exception e){

        }


        Properties props = new Properties();
        props.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, bootstrapserver);

        //configure the following three settings for SSL Encryption
//        props.put(CommonClientConfigs.SECURITY_PROTOCOL_CONFIG, "SASL_SSL");
//        props.put(SslConfigs.SSL_TRUSTSTORE_LOCATION_CONFIG, "/etc/security/kafka.server.truststore.jks");
//        props.put(SslConfigs.SSL_TRUSTSTORE_PASSWORD_CONFIG,  "password");
//
//        // configure the following three settings for SSL Authentication
//        props.put(SslConfigs.SSL_KEYSTORE_LOCATION_CONFIG, "/etc/security/kafka.server.keystore.jks");
//        props.put(SslConfigs.SSL_KEYSTORE_PASSWORD_CONFIG, "password");
//        props.put(SslConfigs.SSL_KEY_PjASSWORD_CONFIG, "password");
//        props.put("sasl.kerberos.service.name","kafka");
        props.put(ProducerConfig.ACKS_CONFIG, "all");
        props.put(ProducerConfig.RETRIES_CONFIG, 0);
        props.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, "org.apache.kafka.common.serialization.StringSerializer");
        props.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, "org.apache.kafka.common.serialization.StringSerializer");

        Producer<String, String> producer = new KafkaProducer<String, String>(props);

        String[] msg = { "{\"msgSourceIP\":\"172.27.76.131\",\"msgCreatedBy\":\"hive\",\"msgCreationTime\":1549012603308,\"message\":{\"entities\":{\"referredEntities\":{\"-25455115743814569\":{\"typeName\":\"hive_db\",\"attributes\":{\"owner\":\"public\",\"ownerType\":\"ROLE\",\"qualifiedName\":\"default@mycluster0\",\"clusterName\":\"mycluster0\",\"name\":\"default\",\"description\":\"Default Hive database\",\"location\":\"hdfs://mycluster0/apps/hive/warehouse\",\"parameters\":{\"repl.source.for\":\"hivepolicy1\"}},\"guid\":\"-25455115743814569\",\"version\":0},\"-25455115743814572\":{\"typeName\":\"hive_column\",\"attributes\":{\"owner\":\"hive\",\"qualifiedName\":\"default.ttt11.id@mycluster0\",\"name\":\"id\",\"position\":0,\"type\":\"int\",\"table\":{\"guid\":\"-25455115743814570\",\"typeName\":\"hive_table\",\"uniqueAttributes\":{\"qualifiedName\":\"default.ttt11@mycluster0\"}}},\"guid\":\"-25455115743814572\",\"version\":0},\"-25455115743814573\":{\"typeName\":\"hive_column\",\"attributes\":{\"owner\":\"hive\",\"qualifiedName\":\"default.ttt11.name@mycluster0\",\"name\":\"name\",\"position\":1,\"type\":\"string\",\"table\":{\"guid\":\"-25455115743814570\",\"typeName\":\"hive_table\",\"uniqueAttributes\":{\"qualifiedName\":\"default.ttt11@mycluster0\"}}},\"guid\":\"-25455115743814573\",\"version\":0},\"-25455115743814571\":{\"typeName\":\"hive_storagedesc\",\"attributes\":{\"qualifiedName\":\"default.ttt11@mycluster0_storage\",\"storedAsSubDirectories\":false,\"location\":\"hdfs://mycluster0/apps/hive/warehouse/ttt11\",\"compressed\":false,\"inputFormat\":\"org.apache.hadoop.mapred.TextInputFormat\",\"parameters\":{},\"outputFormat\":\"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat\",\"table\":{\"guid\":\"-25455115743814570\",\"typeName\":\"hive_table\",\"uniqueAttributes\":{\"qualifiedName\":\"default.ttt11@mycluster0\"}},\"serdeInfo\":{\"typeName\":\"hive_serde\",\"attributes\":{\"serializationLib\":\"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\",\"parameters\":{\"serialization.format\":\"1\"}}},\"numBuckets\":-1},\"guid\":\"-25455115743814571\",\"version\":0}},\"entities\":[{\"typeName\":\"hive_table\",\"attributes\":{\"owner\":\"hive\",\"temporary\":false,\"lastAccessTime\":1549012603000,\"qualifiedName\":\"default.ttt11@mycluster0\",\"columns\":[{\"guid\":\"-25455115743814572\",\"typeName\":\"hive_column\",\"uniqueAttributes\":{\"qualifiedName\":\"default.ttt11.id@mycluster0\"}},{\"guid\":\"-25455115743814573\",\"typeName\":\"hive_column\",\"uniqueAttributes\":{\"qualifiedName\":\"default.ttt11.name@mycluster0\"}}],\"tableType\":\"MANAGED_TABLE\",\"sd\":{\"guid\":\"-25455115743814571\",\"typeName\":\"hive_storagedesc\",\"uniqueAttributes\":{\"qualifiedName\":\"default.ttt11@mycluster0_storage\"}},\"createTime\":1549012603000,\"name\":\"ttt11\",\"partitionKeys\":[],\"parameters\":{\"totalSize\":\"0\",\"numRows\":\"0\",\"rawDataSize\":\"0\",\"COLUMN_STATS_ACCURATE\":\"{\\\"BASIC_STATS\\\":\\\"true\\\"}\",\"numFiles\":\"0\",\"transient_lastDdlTime\":\"1549012603\"},\"db\":{\"guid\":\"-25455115743814569\",\"typeName\":\"hive_db\",\"uniqueAttributes\":{\"qualifiedName\":\"default@mycluster0\"}},\"retention\":0},\"guid\":\"-25455115743814570\",\"version\":0}]},\"type\":\"ENTITY_CREATE_V2\",\"user\":\"hive\"},\"version\":{\"version\":\"1.0.0\"},\"msgCompressionKind\":\"NONE\",\"msgSplitIdx\":1,\"msgSplitCount\":1}",
                "{\"msgSourceIP\":\"172.27.76.131\",\"msgCreatedBy\":\"hive\",\"msgCreationTime\":1549012729326,\"message\":{\"entities\":{\"referredEntities\":{\"-25455115743814576\":{\"typeName\":\"hive_storagedesc\",\"attributes\":{\"qualifiedName\":\"default.ttt11@mycluster0_storage\",\"storedAsSubDirectories\":false,\"location\":\"hdfs://mycluster0/apps/hive/warehouse/ttt11\",\"compressed\":false,\"inputFormat\":\"org.apache.hadoop.mapred.TextInputFormat\",\"parameters\":{},\"outputFormat\":\"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat\",\"table\":{\"guid\":\"-25455115743814575\",\"typeName\":\"hive_table\",\"uniqueAttributes\":{\"qualifiedName\":\"default.ttt11@mycluster0\"}},\"serdeInfo\":{\"typeName\":\"hive_serde\",\"attributes\":{\"serializationLib\":\"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\",\"parameters\":{\"serialization.format\":\"1\"}}},\"numBuckets\":-1},\"guid\":\"-25455115743814576\",\"version\":0},\"-25455115743814577\":{\"typeName\":\"hive_column\",\"attributes\":{\"owner\":\"hive\",\"qualifiedName\":\"default.ttt11.id@mycluster0\",\"name\":\"id\",\"position\":0,\"type\":\"int\",\"table\":{\"guid\":\"-25455115743814575\",\"typeName\":\"hive_table\",\"uniqueAttributes\":{\"qualifiedName\":\"default.ttt11@mycluster0\"}}},\"guid\":\"-25455115743814577\",\"version\":0}},\"entities\":[{\"typeName\":\"hive_table\",\"attributes\":{\"owner\":\"hive\",\"temporary\":false,\"lastAccessTime\":1549012603000,\"qualifiedName\":\"default.ttt11@mycluster0\",\"columns\":[{\"guid\":\"-25455115743814577\",\"typeName\":\"hive_column\",\"uniqueAttributes\":{\"qualifiedName\":\"default.ttt11.id@mycluster0\"}}],\"tableType\":\"MANAGED_TABLE\",\"sd\":{\"guid\":\"-25455115743814576\",\"typeName\":\"hive_storagedesc\",\"uniqueAttributes\":{\"qualifiedName\":\"default.ttt11@mycluster0_storage\"}},\"createTime\":1549012603000,\"name\":\"ttt11\",\"partitionKeys\":[],\"parameters\":{\"last_modified_time\":\"1549012729\",\"totalSize\":\"0\",\"numRows\":\"0\",\"rawDataSize\":\"0\",\"numFiles\":\"0\",\"transient_lastDdlTime\":\"1549012729\",\"last_modified_by\":\"hive\"},\"db\":{\"typeName\":\"hive_db\",\"uniqueAttributes\":{\"qualifiedName\":\"default@mycluster0\"}},\"retention\":0},\"guid\":\"-25455115743814575\",\"version\":0}]},\"type\":\"ENTITY_FULL_UPDATE_V2\",\"user\":\"hive\"},\"version\":{\"version\":\"1.0.0\"},\"msgCompressionKind\":\"NONE\",\"msgSplitIdx\":1,\"msgSplitCount\":1}",
                "{\"msgSourceIP\":\"172.27.76.131\",\"msgCreatedBy\":\"hive\",\"msgCreationTime\":1549012765062,\"message\":{\"entities\":{\"referredEntities\":{\"-25455115743814580\":{\"typeName\":\"hive_storagedesc\",\"attributes\":{\"qualifiedName\":\"default.ttt11@mycluster0_storage\",\"storedAsSubDirectories\":false,\"location\":\"hdfs://mycluster0/apps/hive/warehouse/ttt11\",\"compressed\":false,\"inputFormat\":\"org.apache.hadoop.mapred.TextInputFormat\",\"parameters\":{},\"outputFormat\":\"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat\",\"table\":{\"guid\":\"-25455115743814579\",\"typeName\":\"hive_table\",\"uniqueAttributes\":{\"qualifiedName\":\"default.ttt11@mycluster0\"}},\"serdeInfo\":{\"typeName\":\"hive_serde\",\"attributes\":{\"serializationLib\":\"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\",\"parameters\":{\"serialization.format\":\"1\"}}},\"numBuckets\":-1},\"guid\":\"-25455115743814580\",\"version\":0},\"-25455115743814581\":{\"typeName\":\"hive_column\",\"attributes\":{\"owner\":\"hive\",\"qualifiedName\":\"default.ttt11.id@mycluster0\",\"name\":\"id\",\"position\":0,\"type\":\"int\",\"table\":{\"guid\":\"-25455115743814579\",\"typeName\":\"hive_table\",\"uniqueAttributes\":{\"qualifiedName\":\"default.ttt11@mycluster0\"}}},\"guid\":\"-25455115743814581\",\"version\":0},\"-25455115743814582\":{\"typeName\":\"hive_column\",\"attributes\":{\"owner\":\"hive\",\"qualifiedName\":\"default.ttt11.name@mycluster0\",\"name\":\"name\",\"position\":1,\"type\":\"string\",\"table\":{\"guid\":\"-25455115743814579\",\"typeName\":\"hive_table\",\"uniqueAttributes\":{\"qualifiedName\":\"default.ttt11@mycluster0\"}}},\"guid\":\"-25455115743814582\",\"version\":0}},\"entities\":[{\"typeName\":\"hive_table\",\"attributes\":{\"owner\":\"hive\",\"temporary\":false,\"lastAccessTime\":1549012603000,\"qualifiedName\":\"default.ttt11@mycluster0\",\"columns\":[{\"guid\":\"-25455115743814581\",\"typeName\":\"hive_column\",\"uniqueAttributes\":{\"qualifiedName\":\"default.ttt11.id@mycluster0\"}},{\"guid\":\"-25455115743814582\",\"typeName\":\"hive_column\",\"uniqueAttributes\":{\"qualifiedName\":\"default.ttt11.name@mycluster0\"}}],\"tableType\":\"MANAGED_TABLE\",\"sd\":{\"guid\":\"-25455115743814580\",\"typeName\":\"hive_storagedesc\",\"uniqueAttributes\":{\"qualifiedName\":\"default.ttt11@mycluster0_storage\"}},\"createTime\":1549012603000,\"name\":\"ttt11\",\"partitionKeys\":[],\"parameters\":{\"last_modified_time\":\"1549012764\",\"totalSize\":\"0\",\"numRows\":\"0\",\"rawDataSize\":\"0\",\"numFiles\":\"0\",\"transient_lastDdlTime\":\"1549012764\",\"last_modified_by\":\"hive\"},\"db\":{\"typeName\":\"hive_db\",\"uniqueAttributes\":{\"qualifiedName\":\"default@mycluster0\"}},\"retention\":0},\"guid\":\"-25455115743814579\",\"version\":0}]},\"type\":\"ENTITY_FULL_UPDATE_V2\",\"user\":\"hive\"},\"version\":{\"version\":\"1.0.0\"},\"msgCompressionKind\":\"NONE\",\"msgSplitIdx\":1,\"msgSplitCount\":1}" ,
                "{\"msgSourceIP\":\"172.27.76.131\",\"msgCreatedBy\":\"hive\",\"msgCreationTime\":1549012773570,\"message\":{\"entities\":{\"referredEntities\":{\"-25455115743814585\":{\"typeName\":\"hive_storagedesc\",\"attributes\":{\"qualifiedName\":\"default.ttt11@mycluster0_storage\",\"storedAsSubDirectories\":false,\"location\":\"hdfs://mycluster0/apps/hive/warehouse/ttt11\",\"compressed\":false,\"inputFormat\":\"org.apache.hadoop.mapred.TextInputFormat\",\"parameters\":{},\"outputFormat\":\"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat\",\"table\":{\"guid\":\"-25455115743814584\",\"typeName\":\"hive_table\",\"uniqueAttributes\":{\"qualifiedName\":\"default.ttt11@mycluster0\"}},\"serdeInfo\":{\"typeName\":\"hive_serde\",\"attributes\":{\"serializationLib\":\"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\",\"parameters\":{\"serialization.format\":\"1\"}}},\"numBuckets\":-1},\"guid\":\"-25455115743814585\",\"version\":0},\"-25455115743814586\":{\"typeName\":\"hive_column\",\"attributes\":{\"owner\":\"hive\",\"qualifiedName\":\"default.ttt11.id@mycluster0\",\"name\":\"id\",\"position\":0,\"type\":\"int\",\"table\":{\"guid\":\"-25455115743814584\",\"typeName\":\"hive_table\",\"uniqueAttributes\":{\"qualifiedName\":\"default.ttt11@mycluster0\"}}},\"guid\":\"-25455115743814586\",\"version\":0}},\"entities\":[{\"typeName\":\"hive_table\",\"attributes\":{\"owner\":\"hive\",\"temporary\":false,\"lastAccessTime\":1549012603000,\"qualifiedName\":\"default.ttt11@mycluster0\",\"columns\":[{\"guid\":\"-25455115743814586\",\"typeName\":\"hive_column\",\"uniqueAttributes\":{\"qualifiedName\":\"default.ttt11.id@mycluster0\"}}],\"tableType\":\"MANAGED_TABLE\",\"sd\":{\"guid\":\"-25455115743814585\",\"typeName\":\"hive_storagedesc\",\"uniqueAttributes\":{\"qualifiedName\":\"default.ttt11@mycluster0_storage\"}},\"createTime\":1549012603000,\"name\":\"ttt11\",\"partitionKeys\":[],\"parameters\":{\"last_modified_time\":\"1549012773\",\"totalSize\":\"0\",\"numRows\":\"0\",\"rawDataSize\":\"0\",\"numFiles\":\"0\",\"transient_lastDdlTime\":\"1549012773\",\"last_modified_by\":\"hive\"},\"db\":{\"typeName\":\"hive_db\",\"uniqueAttributes\":{\"qualifiedName\":\"default@mycluster0\"}},\"retention\":0},\"guid\":\"-25455115743814584\",\"version\":0}]},\"type\":\"ENTITY_FULL_UPDATE_V2\",\"user\":\"hive\"},\"version\":{\"version\":\"1.0.0\"},\"msgCompressionKind\":\"NONE\",\"msgSplitIdx\":1,\"msgSplitCount\":1}",
                "{\"msgSourceIP\":\"172.27.76.131\",\"msgCreatedBy\":\"hive\",\"msgCreationTime\":1549012765062,\"message\":{\"entities\":{\"referredEntities\":{\"-25455115743814580\":{\"typeName\":\"hive_storagedesc\",\"attributes\":{\"qualifiedName\":\"default.ttt11@mycluster0_storage\",\"storedAsSubDirectories\":false,\"location\":\"hdfs://mycluster0/apps/hive/warehouse/ttt11\",\"compressed\":false,\"inputFormat\":\"org.apache.hadoop.mapred.TextInputFormat\",\"parameters\":{},\"outputFormat\":\"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat\",\"table\":{\"guid\":\"-25455115743814579\",\"typeName\":\"hive_table\",\"uniqueAttributes\":{\"qualifiedName\":\"default.ttt11@mycluster0\"}},\"serdeInfo\":{\"typeName\":\"hive_serde\",\"attributes\":{\"serializationLib\":\"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\",\"parameters\":{\"serialization.format\":\"1\"}}},\"numBuckets\":-1},\"guid\":\"-25455115743814580\",\"version\":0},\"-25455115743814581\":{\"typeName\":\"hive_column\",\"attributes\":{\"owner\":\"hive\",\"qualifiedName\":\"default.ttt11.id@mycluster0\",\"name\":\"id\",\"position\":0,\"type\":\"int\",\"table\":{\"guid\":\"-25455115743814579\",\"typeName\":\"hive_table\",\"uniqueAttributes\":{\"qualifiedName\":\"default.ttt11@mycluster0\"}}},\"guid\":\"-25455115743814581\",\"version\":0},\"-25455115743814582\":{\"typeName\":\"hive_column\",\"attributes\":{\"owner\":\"hive\",\"qualifiedName\":\"default.ttt11.name@mycluster0\",\"name\":\"name\",\"position\":1,\"type\":\"string\",\"table\":{\"guid\":\"-25455115743814579\",\"typeName\":\"hive_table\",\"uniqueAttributes\":{\"qualifiedName\":\"default.ttt11@mycluster0\"}}},\"guid\":\"-25455115743814582\",\"version\":0}},\"entities\":[{\"typeName\":\"hive_table\",\"attributes\":{\"owner\":\"hive\",\"temporary\":false,\"lastAccessTime\":1549012603000,\"qualifiedName\":\"default.ttt11@mycluster0\",\"columns\":[{\"guid\":\"-25455115743814581\",\"typeName\":\"hive_column\",\"uniqueAttributes\":{\"qualifiedName\":\"default.ttt11.id@mycluster0\"}},{\"guid\":\"-25455115743814582\",\"typeName\":\"hive_column\",\"uniqueAttributes\":{\"qualifiedName\":\"default.ttt11.name@mycluster0\"}}],\"tableType\":\"MANAGED_TABLE\",\"sd\":{\"guid\":\"-25455115743814580\",\"typeName\":\"hive_storagedesc\",\"uniqueAttributes\":{\"qualifiedName\":\"default.ttt11@mycluster0_storage\"}},\"createTime\":1549012603000,\"name\":\"ttt11\",\"partitionKeys\":[],\"parameters\":{\"last_modified_time\":\"1549012764\",\"totalSize\":\"0\",\"numRows\":\"0\",\"rawDataSize\":\"0\",\"numFiles\":\"0\",\"transient_lastDdlTime\":\"1549012764\",\"last_modified_by\":\"hive\"},\"db\":{\"typeName\":\"hive_db\",\"uniqueAttributes\":{\"qualifiedName\":\"default@mycluster0\"}},\"retention\":0},\"guid\":\"-25455115743814579\",\"version\":0}]},\"type\":\"ENTITY_FULL_UPDATE_V2\",\"user\":\"hive\"},\"version\":{\"version\":\"1.0.0\"},\"msgCompressionKind\":\"NONE\",\"msgSplitIdx\":1,\"msgSplitCount\":1}" ,
                "{\"msgSourceIP\":\"172.27.76.131\",\"msgCreatedBy\":\"hive\",\"msgCreationTime\":1549012773570,\"message\":{\"entities\":{\"referredEntities\":{\"-25455115743814585\":{\"typeName\":\"hive_storagedesc\",\"attributes\":{\"qualifiedName\":\"default.ttt11@mycluster0_storage\",\"storedAsSubDirectories\":false,\"location\":\"hdfs://mycluster0/apps/hive/warehouse/ttt11\",\"compressed\":false,\"inputFormat\":\"org.apache.hadoop.mapred.TextInputFormat\",\"parameters\":{},\"outputFormat\":\"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat\",\"table\":{\"guid\":\"-25455115743814584\",\"typeName\":\"hive_table\",\"uniqueAttributes\":{\"qualifiedName\":\"default.ttt11@mycluster0\"}},\"serdeInfo\":{\"typeName\":\"hive_serde\",\"attributes\":{\"serializationLib\":\"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\",\"parameters\":{\"serialization.format\":\"1\"}}},\"numBuckets\":-1},\"guid\":\"-25455115743814585\",\"version\":0},\"-25455115743814586\":{\"typeName\":\"hive_column\",\"attributes\":{\"owner\":\"hive\",\"qualifiedName\":\"default.ttt11.id@mycluster0\",\"name\":\"id\",\"position\":0,\"type\":\"int\",\"table\":{\"guid\":\"-25455115743814584\",\"typeName\":\"hive_table\",\"uniqueAttributes\":{\"qualifiedName\":\"default.ttt11@mycluster0\"}}},\"guid\":\"-25455115743814586\",\"version\":0}},\"entities\":[{\"typeName\":\"hive_table\",\"attributes\":{\"owner\":\"hive\",\"temporary\":false,\"lastAccessTime\":1549012603000,\"qualifiedName\":\"default.ttt11@mycluster0\",\"columns\":[{\"guid\":\"-25455115743814586\",\"typeName\":\"hive_column\",\"uniqueAttributes\":{\"qualifiedName\":\"default.ttt11.id@mycluster0\"}}],\"tableType\":\"MANAGED_TABLE\",\"sd\":{\"guid\":\"-25455115743814585\",\"typeName\":\"hive_storagedesc\",\"uniqueAttributes\":{\"qualifiedName\":\"default.ttt11@mycluster0_storage\"}},\"createTime\":1549012603000,\"name\":\"ttt11\",\"partitionKeys\":[],\"parameters\":{\"last_modified_time\":\"1549012773\",\"totalSize\":\"0\",\"numRows\":\"0\",\"rawDataSize\":\"0\",\"numFiles\":\"0\",\"transient_lastDdlTime\":\"1549012773\",\"last_modified_by\":\"hive\"},\"db\":{\"typeName\":\"hive_db\",\"uniqueAttributes\":{\"qualifiedName\":\"default@mycluster0\"}},\"retention\":0},\"guid\":\"-25455115743814584\",\"version\":0}]},\"type\":\"ENTITY_FULL_UPDATE_V2\",\"user\":\"hive\"},\"version\":{\"version\":\"1.0.0\"},\"msgCompressionKind\":\"NONE\",\"msgSplitIdx\":1,\"msgSplitCount\":1}",
                "{\"msgSourceIP\":\"172.27.76.131\",\"msgCreatedBy\":\"hive\",\"msgCreationTime\":1549012765062,\"message\":{\"entities\":{\"referredEntities\":{\"-25455115743814580\":{\"typeName\":\"hive_storagedesc\",\"attributes\":{\"qualifiedName\":\"default.ttt11@mycluster0_storage\",\"storedAsSubDirectories\":false,\"location\":\"hdfs://mycluster0/apps/hive/warehouse/ttt11\",\"compressed\":false,\"inputFormat\":\"org.apache.hadoop.mapred.TextInputFormat\",\"parameters\":{},\"outputFormat\":\"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat\",\"table\":{\"guid\":\"-25455115743814579\",\"typeName\":\"hive_table\",\"uniqueAttributes\":{\"qualifiedName\":\"default.ttt11@mycluster0\"}},\"serdeInfo\":{\"typeName\":\"hive_serde\",\"attributes\":{\"serializationLib\":\"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\",\"parameters\":{\"serialization.format\":\"1\"}}},\"numBuckets\":-1},\"guid\":\"-25455115743814580\",\"version\":0},\"-25455115743814581\":{\"typeName\":\"hive_column\",\"attributes\":{\"owner\":\"hive\",\"qualifiedName\":\"default.ttt11.id@mycluster0\",\"name\":\"id\",\"position\":0,\"type\":\"int\",\"table\":{\"guid\":\"-25455115743814579\",\"typeName\":\"hive_table\",\"uniqueAttributes\":{\"qualifiedName\":\"default.ttt11@mycluster0\"}}},\"guid\":\"-25455115743814581\",\"version\":0},\"-25455115743814582\":{\"typeName\":\"hive_column\",\"attributes\":{\"owner\":\"hive\",\"qualifiedName\":\"default.ttt11.name@mycluster0\",\"name\":\"name\",\"position\":1,\"type\":\"string\",\"table\":{\"guid\":\"-25455115743814579\",\"typeName\":\"hive_table\",\"uniqueAttributes\":{\"qualifiedName\":\"default.ttt11@mycluster0\"}}},\"guid\":\"-25455115743814582\",\"version\":0}},\"entities\":[{\"typeName\":\"hive_table\",\"attributes\":{\"owner\":\"hive\",\"temporary\":false,\"lastAccessTime\":1549012603000,\"qualifiedName\":\"default.ttt11@mycluster0\",\"columns\":[{\"guid\":\"-25455115743814581\",\"typeName\":\"hive_column\",\"uniqueAttributes\":{\"qualifiedName\":\"default.ttt11.id@mycluster0\"}},{\"guid\":\"-25455115743814582\",\"typeName\":\"hive_column\",\"uniqueAttributes\":{\"qualifiedName\":\"default.ttt11.name@mycluster0\"}}],\"tableType\":\"MANAGED_TABLE\",\"sd\":{\"guid\":\"-25455115743814580\",\"typeName\":\"hive_storagedesc\",\"uniqueAttributes\":{\"qualifiedName\":\"default.ttt11@mycluster0_storage\"}},\"createTime\":1549012603000,\"name\":\"ttt11\",\"partitionKeys\":[],\"parameters\":{\"last_modified_time\":\"1549012764\",\"totalSize\":\"0\",\"numRows\":\"0\",\"rawDataSize\":\"0\",\"numFiles\":\"0\",\"transient_lastDdlTime\":\"1549012764\",\"last_modified_by\":\"hive\"},\"db\":{\"typeName\":\"hive_db\",\"uniqueAttributes\":{\"qualifiedName\":\"default@mycluster0\"}},\"retention\":0},\"guid\":\"-25455115743814579\",\"version\":0}]},\"type\":\"ENTITY_FULL_UPDATE_V2\",\"user\":\"hive\"},\"version\":{\"version\":\"1.0.0\"},\"msgCompressionKind\":\"NONE\",\"msgSplitIdx\":1,\"msgSplitCount\":1}"
        };


      //  String test = "{\"version\":{\"version\":\"1.0.0\"},\"message\":{\"entities\":[{\"jsonClass\":\"org.apache.atlas.typesystem.json.InstanceSerialization$_Reference\",\"id\":{\"jsonClass\":\"org.apache.atlas.typesystem.json.InstanceSerialization$_Id\",\"id\":\"-269129065644035\",\"version\":0,\"typeName\":\"hive_db\",\"state\":\"ACTIVE\"},\"typeName\":\"hive_db\",\"values\":{\"name\":\"default\",\"location\":\"hdfs://rs-atl-290517-1.openstacklocal:8020/apps/hive/warehouse\",\"description\":\"Default Hive database\",\"ownerType\":2,\"qualifiedName\":\"default@ce30\",\"owner\":\"public\",\"clusterName\":\"ce30\",\"parameters\":{}},\"traitNames\":[],\"traits\":{},\"systemAttributes\":{}},{\"jsonClass\":\"org.apache.atlas.typesystem.json.InstanceSerialization$_Reference\",\"id\":{\"jsonClass\":\"org.apache.atlas.typesystem.json.InstanceSerialization$_Id\",\"id\":\"-269129065644034\",\"version\":0,\"typeName\":\"hive_table\",\"state\":\"ACTIVE\"},\"typeName\":\"hive_table\",\"values\":{\"tableType\":\"MANAGED_TABLE\",\"name\":\"testtabl1e"+i+"\",\"createTime\":\"2017-06-01T09:21:32.000Z\",\"temporary\":false,\"db\":{\"jsonClass\":\"org.apache.atlas.typesystem.json.InstanceSerialization$_Reference\",\"id\":{\"jsonClass\":\"org.apache.atlas.typesystem.json.InstanceSerialization$_Id\",\"id\":\"-269129065644035\",\"version\":0,\"typeName\":\"hive_db\",\"state\":\"ACTIVE\"},\"typeName\":\"hive_db\",\"values\":{\"name\":\"default\",\"location\":\"hdfs://rs-atl-290517-1.openstacklocal:8020/apps/hive/warehouse\",\"description\":\"Default Hive database\",\"ownerType\":2,\"qualifiedName\":\"default@ce30\",\"owner\":\"public\",\"clusterName\":\"ce30\",\"parameters\":{}},\"traitNames\":[],\"traits\":{},\"systemAttributes\":{}},\"retention\":0,\"qualifiedName\":\"default.testtabl1e@ce30\",\"columns\":[{\"jsonClass\":\"org.apache.atlas.typesystem.json.InstanceSerialization$_Reference\",\"id\":{\"jsonClass\":\"org.apache.atlas.typesystem.json.InstanceSerialization$_Id\",\"id\":\"-269129065644032\",\"version\":0,\"typeName\":\"hive_column\",\"state\":\"ACTIVE\"},\"typeName\":\"hive_column\",\"values\":{\"name\":\"name\",\"qualifiedName\":\"default.testtabl1e.name@ce30\",\"position\":0,\"owner\":\"anonymous\",\"type\":\"int\",\"table\":{\"jsonClass\":\"org.apache.atlas.typesystem.json.InstanceSerialization$_Id\",\"id\":\"-269129065644034\",\"version\":0,\"typeName\":\"hive_table\",\"state\":\"ACTIVE\"}},\"traitNames\":[],\"traits\":{},\"systemAttributes\":{}}],\"lastAccessTime\":\"2017-06-01T09:21:32.000Z\",\"owner\":\"anonymous\",\"sd\":{\"jsonClass\":\"org.apache.atlas.typesystem.json.InstanceSerialization$_Reference\",\"id\":{\"jsonClass\":\"org.apache.atlas.typesystem.json.InstanceSerialization$_Id\",\"id\":\"-269129065644033\",\"version\":0,\"typeName\":\"hive_storagedesc\",\"state\":\"ACTIVE\"},\"typeName\":\"hive_storagedesc\",\"values\":{\"location\":\"hdfs://rs-atl-290517-1.openstacklocal:8020/apps/hive/warehouse/testtabl1e\",\"serdeInfo\":{\"jsonClass\":\"org.apache.atlas.typesystem.json.InstanceSerialization$_Struct\",\"typeName\":\"hive_serde\",\"values\":{\"serializationLib\":\"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\",\"parameters\":{\"serialization.format\":\"1\"}}},\"qualifiedName\":\"default.testtabl1e@ce30_storage\",\"outputFormat\":\"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat\",\"compressed\":false,\"numBuckets\":-1,\"inputFormat\":\"org.apache.hadoop.mapred.TextInputFormat\",\"parameters\":{},\"storedAsSubDirectories\":false,\"table\":{\"jsonClass\":\"org.apache.atlas.typesystem.json.InstanceSerialization$_Id\",\"id\":\"-269129065644034\",\"version\":0,\"typeName\":\"hive_table\",\"state\":\"ACTIVE\"}},\"traitNames\":[],\"traits\":{},\"systemAttributes\":{}},\"parameters\":{\"rawDataSize\":\"0\",\"numFiles\":\"0\",\"transient_lastDdlTime\":\"1496308892\",\"totalSize\":\"0\",\"COLUMN_STATS_ACCURATE\":\"{\\\"BASIC_STATS\\\":\\\"true\\\"}\",\"numRows\":\"0\"},\"partitionKeys\":[]},\"traitNames\":[],\"traits\":{},\"systemAttributes\":{}}],\"type\":\"ENTITY_FULL_UPDATE\",\"user\":\"anonymous\"}}";

        TestCallback callback = new TestCallback();
        for (int i = 0 ; i < msg.length ; i++) {
            Random rnd = new Random();

          //  String test = "{\"version\":{\"version\":\"1.0.0\"},\"message\":{\"entities\":[{\"jsonClass\":\"org.apache.atlas.typesystem.json.InstanceSerialization$_Reference\",\"id\":{\"jsonClass\":\"org.apache.atlas.typesystem.json.InstanceSerialization$_Id\",\"id\":\"-269129065644035\",\"version\":0,\"typeName\":\"hive_db\",\"state\":\"ACTIVE\"},\"typeName\":\"hive_db\",\"values\":{\"name\":\"default\",\"location\":\"hdfs://rs-atl-290517-1.openstacklocal:8020/apps/hive/warehouse\",\"description\":\"Default Hive database\",\"ownerType\":2,\"qualifiedName\":\"default@ce30\",\"owner\":\"public\",\"clusterName\":\"ce30\",\"parameters\":{}},\"traitNames\":[],\"traits\":{},\"systemAttributes\":{}},{\"jsonClass\":\"org.apache.atlas.typesystem.json.InstanceSerialization$_Reference\",\"id\":{\"jsonClass\":\"org.apache.atlas.typesystem.json.InstanceSerialization$_Id\",\"id\":\"-269129065644034\",\"version\":0,\"typeName\":\"hive_table\",\"state\":\"ACTIVE\"},\"typeName\":\"hive_table\",\"values\":{\"tableType\":\"MANAGED_TABLE\",\"name\":\"testtabl1e"+i+"\",\"createTime\":\"2017-06-01T09:21:32.000Z\",\"temporary\":false,\"db\":{\"jsonClass\":\"org.apache.atlas.typesystem.json.InstanceSerialization$_Reference\",\"id\":{\"jsonClass\":\"org.apache.atlas.typesystem.json.InstanceSerialization$_Id\",\"id\":\"-269129065644035\",\"version\":0,\"typeName\":\"hive_db\",\"state\":\"ACTIVE\"},\"typeName\":\"hive_db\",\"values\":{\"name\":\"default\",\"location\":\"hdfs://rs-atl-290517-1.openstacklocal:8020/apps/hive/warehouse\",\"description\":\"Default Hive database\",\"ownerType\":2,\"qualifiedName\":\"default@ce30\",\"owner\":\"public\",\"clusterName\":\"ce30\",\"parameters\":{}},\"traitNames\":[],\"traits\":{},\"systemAttributes\":{}},\"retention\":0,\"qualifiedName\":\"default.testtabl1e"+i+"@ce30\",\"columns\":[{\"jsonClass\":\"org.apache.atlas.typesystem.json.InstanceSerialization$_Reference\",\"id\":{\"jsonClass\":\"org.apache.atlas.typesystem.json.InstanceSerialization$_Id\",\"id\":\"-269129065644032\",\"version\":0,\"typeName\":\"hive_column\",\"state\":\"ACTIVE\"},\"typeName\":\"hive_column\",\"values\":{\"name\":\"name\",\"qualifiedName\":\"default.testtabl1e"+i+".name@ce30\",\"position\":0,\"owner\":\"anonymous\",\"type\":\"int\",\"table\":{\"jsonClass\":\"org.apache.atlas.typesystem.json.InstanceSerialization$_Id\",\"id\":\"-269129065644034\",\"version\":0,\"typeName\":\"hive_table\",\"state\":\"ACTIVE\"}},\"traitNames\":[],\"traits\":{},\"systemAttributes\":{}}],\"lastAccessTime\":\"2017-06-01T09:21:32.000Z\",\"owner\":\"anonymous\",\"sd\":{\"jsonClass\":\"org.apache.atlas.typesystem.json.InstanceSerialization$_Reference\",\"id\":{\"jsonClass\":\"org.apache.atlas.typesystem.json.InstanceSerialization$_Id\",\"id\":\"-269129065644033\",\"version\":0,\"typeName\":\"hive_storagedesc\",\"state\":\"ACTIVE\"},\"typeName\":\"hive_storagedesc\",\"values\":{\"location\":\"hdfs://rs-atl-290517-1.openstacklocal:8020/apps/hive/warehouse/testtabl1e\",\"serdeInfo\":{\"jsonClass\":\"org.apache.atlas.typesystem.json.InstanceSerialization$_Struct\",\"typeName\":\"hive_serde\",\"values\":{\"serializationLib\":\"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\",\"parameters\":{\"serialization.format\":\"1\"}}},\"qualifiedName\":\"default.testtabl1e@ce30_storage\",\"outputFormat\":\"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat\",\"compressed\":false,\"numBuckets\":-1,\"inputFormat\":\"org.apache.hadoop.mapred.TextInputFormat\",\"parameters\":{},\"storedAsSubDirectories\":false,\"table\":{\"jsonClass\":\"org.apache.atlas.typesystem.json.InstanceSerialization$_Id\",\"id\":\"-269129065644034\",\"version\":0,\"typeName\":\"hive_table\",\"state\":\"ACTIVE\"}},\"traitNames\":[],\"traits\":{},\"systemAttributes\":{}},\"parameters\":{\"rawDataSize\":\"0\",\"numFiles\":\"0\",\"transient_lastDdlTime\":\"1496308892\",\"totalSize\":\"0\",\"COLUMN_STATS_ACCURATE\":\"{\\\"BASIC_STATS\\\":\\\"true\\\"}\",\"numRows\":\"0\"},\"partitionKeys\":[]},\"traitNames\":[],\"traits\":{},\"systemAttributes\":{}}],\"type\":\"ENTITY_FULL_UPDATE\",\"user\":\"anonymous\"}}";
            ProducerRecord<String, String> data = new ProducerRecord<String, String>(
                    "ATLAS_HOOK", "key-" , msg[i] );
            producer.send(data, callback);
            try {
                Thread.sleep(2000L);
            }catch (Exception e) {
                e.printStackTrace();
            }

        }

        producer.close();
    }


    private static class TestCallback implements Callback {
        @Override
        public void onCompletion(RecordMetadata recordMetadata, Exception e) {
            if (e != null) {
                System.out.println("Error while producing message to topic :" + recordMetadata);
                e.printStackTrace();
            } else {
                String message = String.format("sent message to topic:%s partition:%s  offset:%s", recordMetadata.topic(), recordMetadata.partition(), recordMetadata.offset());
                System.out.println(message);
            }
        }
    }

}